wss.turnup.ecs.create_service:
  serviceName: ${WSS_NAME}
  cluster: $(cluster.ecs.create_cluster.cluster.clusterArn)
  taskDefinition: $(wss.turnup.ecs.register_task_definition.taskDefinition.taskDefinitionArn)
  desiredCount: ${WSS_CONTAINER_TASK_COUNT}
  loadBalancers:
    - targetGroupArn: $(wss.turnup.elb.create_target_group.TargetGroups.0.TargetGroupArn)
      containerName: ${WSS_NAME}
      containerPort: ${WSS_CONTAINER_PORT}
  launchType: FARGATE
  networkConfiguration:
    awsvpcConfiguration:
      subnets: $(infra.get_subnet_ids)
      securityGroups:
        - $(wss.ec2.describe_security_groups.SecurityGroups.0.GroupId)
      assignPublicIp: ENABLED
wss.turnup.ecs.update_service:
  service: ${WSS_NAME}
  cluster: $(cluster.ecs.create_cluster.cluster.clusterArn)
  taskDefinition: $(wss.turnup.ecs.register_task_definition.taskDefinition.taskDefinitionArn)
  forceNewDeployment: true
