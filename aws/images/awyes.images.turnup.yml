images.turnup.gitconfig:
images.turnup.gitrev:
  - $(images.turnup.gitconfig)
---
images.turnup.app.image.build:
  tag: ${SAGE_ACCOUNT_ID}.dkr.ecr.${SAGE_REGION}.amazonaws.com/${APP_ECR_REPO_NAME}:$(images.turnup.gitrev)
  path: ${APP_PATH}
  platform: ${APP_IMAGE_PLATFORM}
  dockerfile: Dockerfile
images.turnup.app.image.push:
  repository: ${SAGE_ACCOUNT_ID}.dkr.ecr.${SAGE_REGION}.amazonaws.com/${APP_ECR_REPO_NAME}
  tag: $(images.turnup.gitrev)
  auth_config:
    username: ${SAGE_AWS_USER}
    password: $(repos.auth.re.sub)
---
images.turnup.secrets.image.build:
  tag: ${SAGE_ACCOUNT_ID}.dkr.ecr.${SAGE_REGION}.amazonaws.com/${SECRETS_ECR_REPO_NAME}:$(images.turnup.gitrev)
  path: ${SECRETS_LAMBDA_PATH}
  platform: ${SECRETS_LAMBDA_IMAGE_PLATFORM}
  dockerfile: Dockerfile
images.turnup.secrets.image.push:
  repository: ${SAGE_ACCOUNT_ID}.dkr.ecr.${SAGE_REGION}.amazonaws.com/${SECRETS_ECR_REPO_NAME}
  tag: $(images.turnup.gitrev)
  auth_config:
    username: AWS
    password: $(repos.auth.re.sub)
